<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
    <template id="cargar" name="ChatWeb : Agregando la funcionalidad del boton">
        <t t-if="not info">
            <t t-set="info" t-value="request.env['chat_web.channel'].get_livechat_info(channel)"/>
        </t>

        <t t-if="not (order == None)">
            <t t-if="not (order.payment_acquirer_id == None)">          
                <t t-if="not (order.payment_acquirer_id.provider == None)" t-set="is_transfer" t-value="order.payment_acquirer_id.provider == 'transfer'"/>
            </t>
        </t>


            document.addEventListener("DOMContentLoaded", function(event) {
                <t t-if="web_session_required">
                odoo.define('web.session', function (require) {
                    var Session = require('web.Session');
                    var modules = odoo._modules;
                    return new Session(undefined, "<t t-esc="info['server_url']"/>", {modules:modules, use_cors: false});
                });
                </t>
                
                odoo.define('chat_web.support', function (require) {
                    <t t-if="info['available']" t-translation="off">
                        var chat_web = require('chat_window.chat_window');
                        var button = new chat_web.LivechatButton(
                            $('body'),
                            "<t t-esc="info['server_url']"/>",
                            <t t-raw="json.dumps(info.get('options', {}))"/>,
                            <t t-if="is_transfer">
                                "<t t-esc="is_transfer"/>"
                            </t>
                        );
                        button.appendTo($('body'));
                        window.livechat_button = button;
                    </t>
                });
            });
    </template>
    </data>
</odoo>
