<odoo>
  <data>
 <record id="mail_channel_view_search" model="ir.ui.view">
            <field name="name">mail.channel.search</field>
            <field name="model">mail.channel</field>
            <field name="arch" type="xml">
                <search string="Search history">
                    <field name="name"/>
                    <group expand="0" string="Group By...">
                        <filter name="group_by_channel" string="Channel" domain="[]" context="{'group_by':'livechat_channel_id'}"/>
                        <separator orientation="vertical"/>
                        <filter name="group_by_day" string="Creation date (day)" domain="[]" context="{'group_by':'create_date:day'}"/>
                        <filter name="group_by_week" string="Creation date (week)" domain="[]" context="{'group_by':'create_date:week'}"/>
                        <filter name="group_by_month" string="Creation date (month)" domain="[]" context="{'group_by':'create_date:month'}"/>
                        <filter name="group_by_year" string="Creation date (year)" domain="[]" context="{'group_by':'create_date:year'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="mail_channel_view_tree" model="ir.ui.view">
            <field name="name">mail.channel.tree</field>
            <field name="model">mail.channel</field>
            <field name="arch" type="xml">
                <tree string="History" create="false">
                    <field name="create_date" string="Fecha de la sesión"/>
                    <field name="name" string="Asistentes"/>
                </tree>
            </field>
        </record>

        <record id="mail_channel_view_form" model="ir.ui.view">
            <field name="name">mail.channel.form</field>
            <field name="model">mail.channel</field>
            <field name="arch" type="xml">
                <form string="Session Form" create="false" edit="false">
                    <sheet>
                        <group>
                            <group>
                                <field name="name" string="Attendees"/>
                                <field name="create_date" readonly="1" string="Session Date"/>
                            </group>
                        </group>
                        <field name="message_ids" type="tree">
                            <tree string="History">
                                <field name="author_id"/>
                                <field name="body"/>
                                <field name="create_date" groups="base.group_no_one"/>
                            </tree>
                        </field>
                    </sheet>
                </form>
            </field>
        </record>


        <record id="mail_channel_action" model="ir.actions.act_window">
            <field name="name">Historial</field>
            <field name="res_model">mail.channel</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="chat_on_the_web.mail_channel_view_search"/>
            <field name="domain">[('livechat_channel_id', '!=', None)]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p>
                    Tu historial de conversaciones está vacío.
                </p>
            </field>
        </record>
        <record id="mail_channel_action_tree" model="ir.actions.act_window.view">
            <field name="sequence">1</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="mail_channel_view_tree"/>
            <field name="act_window_id" ref="chat_on_the_web.mail_channel_action"/>
        </record>

        <record id="mail_channel_action_form" model="ir.actions.act_window.view">
            <field name="sequence">2</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="chat_on_the_web.mail_channel_view_form"/>
            <field name="act_window_id" ref="chat_on_the_web.mail_channel_action"/>
        </record>

        <record id="mail_channel_action_from_livechat_channel" model="ir.actions.act_window">
            <field name="name">Sessions</field>
            <field name="res_model">mail.channel</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('livechat_channel_id', 'in', [active_id])]</field>
            <field name="context">{
                'search_default_livechat_channel_id': [active_id],
                'default_livechat_channel_id': active_id,
            }</field>
            <field name="search_view_id" ref="mail_channel_view_search"/>
        </record>
        <record id="mail_channel_action_livechat_tree" model="ir.actions.act_window.view">
            <field name="sequence">1</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="mail_channel_view_tree"/>
            <field name="act_window_id" ref="mail_channel_action_from_livechat_channel"/>
        </record>

        <record id="mail_channel_action_livechat_form" model="ir.actions.act_window.view">
            <field name="sequence">2</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="mail_channel_view_form"/>
            <field name="act_window_id" ref="mail_channel_action_from_livechat_channel"/>
        </record>


        <record id="chat_web_channel_action" model="ir.actions.act_window">
            <field name="name">Canales de Chat Web del Sitio</field>
            <field name="res_model">chat_web.channel</field>
            <field name="view_mode">kanban,form</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to define a new website live chat channel.
              </p><p>
                You can create channels for each website on which you want
                to integrate the website live chat widget, allowing your website
                visitors to talk in real time with your operators.
              </p><p>
                Each channel has it's own URL that you can send by email to
                your customers in order to start chatting with you.
              </p>
            </field>
        </record>

        <record id="chat_web_channel_view_kanban" model="ir.ui.view">
            <field name="name">chat.web.channel.kanban</field>
            <field name="model">chat_web.channel</field>
            <field name="arch" type="xml">
                <kanban>
                    <field name="id"/>
                    <field name="name"/>
                    <!--<field name="web_page" widget="url"/>-->
                    <field name="are_you_inside"/>
                    <field name="user_ids"/>
                    <field name="nbr_channel"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click">
                                <div class="o_kanban_image">
                                    <img t-att-src="kanban_image('chat_web.channel', 'image_medium', record.id.raw_value)" class="img-responsive"/>
                                </div>
                                <div class="oe_kanban_details">
                                    <strong class="o_kanban_record_title"><field name="name"/></strong>
                                    <div>
                                        <p>
                                            <i class="fa fa-user"></i>
                                            <t t-esc="(record.user_ids.raw_value || []).length"/> Operadores
                                            <br/>
                                            <i class="fa fa-comments"></i>
                                            <t t-esc="record.nbr_channel.raw_value"/> Sesiones
                                        </p>
                                    </div>
                                    <div class="o_kanban_button">
                                        <button t-if="record.are_you_inside.raw_value" name="action_quit" type="object" class="btn btn-sm btn-primary">Dejar</button>
                                        <button t-if="!record.are_you_inside.raw_value" name="action_join" type="object" class="btn btn-sm btn-primary">Unirse</button>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="im_livechat_channel_view_form" model="ir.ui.view">
            <field name="name">chat_web.channel.form</field>
            <field name="model">chat_web.channel</field>
            <field name="arch" type="xml">
                <form>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="action" attrs="{'invisible':[('nbr_channel','=', 0)]}" name="%(mail_channel_action_from_livechat_channel)d" icon="fa-comments">
                            <field string="Sesiones" name="nbr_channel" widget="statinfo"/>
                        </button>
                    </div>
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name" placeholder="e.g. YourWebsite.com"/>
                        </h1>
                        <div>
                            <button type="object" name="action_join" class="oe_highlight" string="Unirse al Canal" attrs='{"invisible": [["are_you_inside", "=", True]]}'/>
                            <button type="object" name="action_quit" string="Dejar Canal" attrs='{"invisible": [["are_you_inside", "=", False]]}'/>
                            <field name="are_you_inside" invisible="1"/>
                        </div>
                    </div>
                    <!--<group>-->
                        <group string="Operadores">
                            <field name="user_ids" nolabel="1" colspan="2">
                                <kanban>
                                    <field name="id"/>
                                    <field name="name"/>
                                    <templates>
                                        <t t-name="kanban-box">
                                            <div>
                                                <a t-if="!read_only_mode" type="delete" class="fa fa-times pull-right"/>
                                                <div class="o_kanban_image">
                                                    <img t-att-src="kanban_image('res.users', 'image', record.id.raw_value)"/>
                                                </div>
                                                <div class="o_kanban_details">
                                                    <h4 class="o_kanban_record_title"><field name="name"/></h4>
                                                </div>
                                            </div>
                                        </t>
                                    </templates>
                                </kanban>
                            </field>
                            <p class="text-muted">
                                Los operadores que no muestran ninguna actividad en Odoo durante más de 30 minutos se considerarán desconectados.
                            </p>
                        </group>
                        <group string="Opciones">
                            <!--<field name="button_text"/>-->
                            <field name="input_placeholder"/>
                            <field name="default_message" placeholder="e.g. Hola, cómo puedo ayudarte?"/>
                            <field name="no_operator_online"/>
                        </group>

                        <group string="Permiso Especial para enviar archivos">
                            <field name="user_perm_ids" nolabel="1" colspan="2">
                                <kanban>
                                    <field name="id"/>
                                    <field name="name"/>
                                    <templates>
                                        <t t-name="kanban-box">
                                            <div>
                                                <a t-if="!read_only_mode" type="delete" class="fa fa-times pull-right"/>
                                                <div class="o_kanban_image">
                                                    <img t-att-src="kanban_image('res.users', 'image', record.id.raw_value)"/>
                                                </div>
                                                <div class="o_kanban_details">
                                                    <h4 class="o_kanban_record_title"><field name="name"/></h4>
                                                </div>
                                            </div>
                                        </t>
                                    </templates>
                                </kanban>
                            </field>
                            <p class="text-muted">
                                Los usuarios selecionados aquí, son los que tendrán permiso especial para poder subir y enviar archivos desde el Chat Web.
                            </p>
                        </group>

                    <!--</group>-->

                    <!--<div attrs='{"invisible": [["web_page", "=", False]]}'>
                        <separator string="How to use the Website Live Chat widget?"/>
                        <p>
                            Copy and paste this code into your website, within the &lt;head&gt; tag:
                        </p>
                        <field name="script_external" readonly="1" widget="CopyClipboardText"/>
                        <p>
                            or copy this url and send it by email to your customers or suppliers:
                        </p>
                        <field name="web_page" readonly="1" widget="CopyClipboardChar"/>
                        <p>For website built with Odoo CMS, please install the website_livechat module. Then go to Website Admin > Configuration > Settings and select the Website Live Chat Channel you want to add on your website.</p>
                    </div>-->

                   <!--<group string="Channel Rules">
                        <field name="rule_ids" nolabel="1"/>
                    </group>-->
                    <!--<span>Define rules for your live support channel. You can apply an action (disable the support, automatically open your support, or just make the button available) for the given URL, and per country.<br />To identify the country, GeoIP must be installed on your server, otherwise, the countries of the rule will not be taken into account.</span>-->
                </sheet>
                </form>
            </field>
        </record>



        <!--<record id="im_livechat_channel_rule_view_tree" model="ir.ui.view">
            <field name="name">chat.web.channel.rule.tree</field>
            <field name="model">chat_web.channel.rule</field>
            <field name="arch" type="xml">
                <tree string="Rules">
                    <field name="sequence" widget="handle"/>
                    <field name="regex_url"/>
                    <field name="action"/>
                    <field name="country_ids"/>
                </tree>
            </field>
        </record>

        <record id="im_livechat_channel_rule_view_form" model="ir.ui.view">
            <field name="name">chat_web.channel.rule.form</field>
            <field name="model">chat_web.channel.rule</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Channel Rule">
                    <sheet>
                        <group>
                            <field name="action"/>
                            <field name="regex_url"/>
                            <label for="auto_popup_timer" class="oe_inline" attrs="{'invisible': [('action', '!=', 'auto_popup')]}"/>
                            <div class="oe_inline" attrs="{'invisible': [('action', '!=', 'auto_popup')]}">
                                <field name="auto_popup_timer" class="oe_inline"/> seconds
                            </div>
                            <field name="country_ids" widget="many2many_tags"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>-->

        <!-- Canned responses -->
        <record id="chat_web_canned_response_view_tree" model="ir.ui.view">
            <field name="name">chat.web.canned_response.tree</field>
            <field name="model">mail.shortcode</field>
            <field name="arch" type="xml">
                <tree editable="bottom">
                    <field name="source"/>
                    <field name="substitution"/>
                </tree>
            </field>
        </record>

        <record id="chat_web_canned_response_action" model="ir.actions.act_window">
            <field name="name">Canned Responses</field>
            <field name="res_model">mail.shortcode</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="chat_web_canned_response_view_tree"/>
            <field name="domain">[('shortcode_type','=','text')]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new canned response.
              </p><p>
                Canned responses allow you to insert prewritten responses in
                your messages by typing <i>:shortcut</i>. The shortcut is
                replaced directly in your message, so that you can still edit
                it before sending.
              </p>
            </field>
        </record>

        <!-- Menu items -->
        <!--<menuitem
            id="menu_livechat_root"
            name="Chat Web"
            web_icon="chat_web,static/description/icono_mensaje.png"
            sequence="205"/>

        <menuitem
            id="support_channels"
            name="Canales"
            parent="menu_livechat_root"
            action="chat_web_channel_action"
            sequence="5"/>

        <menuitem
            id="menu_reporting_livechat"
            name="Informe"
            parent="menu_livechat_root"
            sequence="50"/>


        <menuitem
            id="session_history"
            name="Historial de sesiones"
            parent="menu_reporting_livechat"
            action="mail_channel_action"
            sequence="1"/>-->






        <menuitem id="menu_livechat_root" parent="website.menu_website_configuration" name="Chat Web" sequence="205"/>

        <menuitem name="Canales"
            id="support_channels"
            action="chat_web_channel_action"
            parent="menu_livechat_root"
            sequence="5"/>


        <menuitem name="Informe"
            id="menu_reporting_livechat"
            parent="menu_livechat_root"
            sequence="50"/>


        <menuitem name="Historial de sesiones"
            id="session_history"
            action="mail_channel_action"
            parent="menu_reporting_livechat"
            sequence="1"/>





  </data>
</odoo>